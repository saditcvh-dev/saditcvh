<div class="select-none text-sm relative overflow-visible text-gray-700 dark:text-neutral-400">


<div
  data-tree-node
  class="flex items-center gap-2 px-2 py-1.5 cursor-pointer rounded
         hover:bg-gray-100 dark:hover:bg-gray-800
         transition-colors duration-200"

      [class.justify-center]="collapsed"
      [class.bg-red-50]="node === selectedNode"
      [class.dark:bg-red-900/30]="node === selectedNode"

      (click)="onNodeClick($event, node)"
      (contextmenu)="onRightClick($event, node)"
      [attr.title]="collapsed ? node.nombre : null"
    >


  <img [src]="getIcon(node)"
     class="w-4 h-4 cursor-pointer opacity-80 dark:opacity-90"
     (click)="onIconClick($event, node)" />

    <span *ngIf="!collapsed" class="truncate cursor-pointer text-gray-700 dark:text-neutral-400" (click)="nodeSelected.emit(node)">
      {{ node.nombre }}
    </span>
    <!-- Icono de abrir en otra ventana -->
<!-- Icono SVG para abrir en nueva ventana -->
<span *ngIf="node.type === 'autorizacion'" 
      class="ml-1 cursor-pointer opacity-60 hover:opacity-100"
      title="Abrir en nueva ventana"
      (click)="openInNewWindow(node); $event.stopPropagation()">
  <!-- Nuevo SVG de abrir -->
  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M14 3h7v7m0-7L10 14M5 10v10h10" />
  </svg>
</span>


  </div>

  <div *ngIf="!collapsed && node._open && node.children?.length"
    class="ml-2.5 pl-3 border-l border-gray-200 dark:border-neutral-700 space-y-0.5">
    <app-tree-node *ngFor="let child of node.children" [node]="child" [selectedNode]="selectedNode"
      [collapsed]="collapsed" (nodeSelected)="onChildSelected($event)" (nodeRightClick)="onChildRightClick($event)">
    </app-tree-node>
  </div>

</div>