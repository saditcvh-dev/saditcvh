<div class="h-full bg-white p-6">

	<div class="flex justify-between items-center mb-6 sticky top-0 bg-white z-10 pb-4">
		<h3 class="text-sm font-bold text-gray-900 uppercase tracking-wide border-l-4 border-[#BC955B] pl-2"> Control de Versiones </h3>
		<button (click)="onOpenUploadModal()" class="flex items-center gap-2 bg-[#691831] text-white text-xs px-3 py-2 rounded hover:bg-[#501225] transition-colors shadow-sm">
			<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
			</svg> Subir Nueva Versión </button>
	</div>
	<!-- <div class="max-h-[60vh] overflow-y-auto pr-2 pt-12 pb-12"> -->
	<div class="max-h-[60vh] overflow-y-auto pr-2 pt-8 pb-12 scrollbar-hide">
		<!-- <div class="max-h-[60vh] overflow-y-auto pr-2"> -->
		<div *ngIf="documentVersions && documentVersions.length > 0" class="relative pl-4 border-l border-gray-200 space-y-8 ml-2">
			<div *ngFor="let version of documentVersions; let first = first" class="relative group">
				<!-- Punto de línea de tiempo -->
				<div class="absolute -left-[21px] bg-white border-2 rounded-full w-3 h-3 mt-1.5 transition-colors" [class.border-green-500]="first" [class.bg-green-500]="first" [class.border-gray-300]="!first">
				</div>
				<div class="bg-gray-50 border border-gray-100 rounded-lg p-4 hover:shadow-md transition-shadow relative">
					<!-- Badge de versión -->
					<div class="absolute -top-3 right-4">
						<span class="px-2 py-1 rounded text-xs font-bold shadow-sm" [class.bg-green-100]="first" [class.text-green-800]="first" [class.bg-gray-200]="!first" [class.text-gray-600]="!first"> v{{ version.version }}
						</span>
					</div>
					<!-- Información de la versión -->
					<div class="mb-3">
						<div class="font-medium text-gray-800 mb-1"> {{ getFileNameFromPath(version.archivosDigitales?.[0]?.ruta_almacenamiento) }}
						</div>
						<div class="text-xs text-gray-500 flex items-center gap-2">
							<span class="flex items-center gap-1">
								<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
								</svg>
								{{ version.archivosDigitales?.[0]?.digitalizadoPor?.first_name
								}}
								{{ version.archivosDigitales?.[0]?.digitalizadoPor?.last_name
								}}
							</span>
							<span>•</span>
							<span class="flex items-center gap-1">
								<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
								</svg>
								{{ version.archivosDigitales?.[0]?.fecha_digitalizacion | fechaLocal }}
							</span>
							<span>•</span>
							<span>{{ formatFileSize(version.archivosDigitales?.[0]?.tamano_bytes) }}
							</span>
						</div>
					</div>
					<!-- Comentario -->
					<p *ngIf="version.comment" class="text-xs text-gray-600 italic mb-3 border-l-2 border-gray-300 pl-2"> "{{ version.comment
						}}" </p>
					<!-- Acciones -->
					<div class="flex items-center justify-between pt-2 border-t border-gray-200">
						<div class="flex items-center gap-2">
							<span *ngIf="first" class="text-xs font-medium text-green-600 bg-green-50 px-2 py-0.5 rounded"> Versión actual </span>
						</div>
						<div class="flex gap-2">
							<button (click)="onDownloadVersion(version)" class="text-xs text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1">
								<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
								</svg> Descargar </button>
							<button *ngIf="!first" (click)="onRestoreVersion(version)" class="text-xs text-orange-600 hover:text-orange-800 font-medium flex items-center gap-1">
								<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
								</svg> Restaurar </button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- Sin historial -->
	<div *ngIf="!documentVersions || documentVersions.length === 0" class="text-center py-10 text-gray-400 text-sm">
		<svg class="w-12 h-12 mx-auto mb-3 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
			<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
		</svg>
		<p class="mb-2">No hay historial de versiones disponible para este documento.</p>
		<p class="text-xs">Sube una versión para comenzar el control de versiones.</p>
	</div>
</div>